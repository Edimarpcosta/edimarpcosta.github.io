<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Dashboard Corporativo</title>
    <!-- Carregamento sob demanda do FontAwesome -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #1abc9c;
            --light: #ecf0f1;
            --dark: #34495e;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --text: #333;
            --text-light: #7f8c8d;
            --card-radius: 12px;
            --anim: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow-hover: 0 10px 25px rgba(0,0,0,0.15);
            --gradient-bg: linear-gradient(135deg, var(--primary), var(--dark));
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            background-color: #f6f8fa;
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
            padding-bottom: 30px;
        }
        
        .header {
            background: var(--gradient-bg);
            color: white;
            padding: 2rem 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
        }
        
        .header h1 {
            font-size: 2.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 2;
            letter-spacing: -0.5px;
        }
        
        .header p {
            opacity: 0.9;
            max-width: 700px;
            position: relative;
            z-index: 2;
            font-weight: 300;
            font-size: 1.1rem;
        }
        
        .header::before {
            content: "";
            position: absolute;
            top: -50%;
            right: -20%;
            width: 60%;
            height: 200%;
            background: rgba(255,255,255,0.05);
            transform: rotate(30deg);
            z-index: 1;
        }
        
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0 30px;
            flex-wrap: wrap;
            gap: 15px;
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        
        .search-box {
            display: flex;
            border-radius: 30px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
            background: white;
            flex: 1;
            max-width: 400px;
            border: 1px solid #eee;
        }
        
        .search-box input {
            flex: 1;
            border: none;
            padding: 12px 18px;
            outline: none;
            font-size: 0.95rem;
            border-radius: 30px;
        }
        
        .search-box button {
            border: none;
            background: var(--secondary);
            color: white;
            padding: 0 20px;
            cursor: pointer;
            transition: background var(--anim);
        }
        
        .search-box button:hover {
            background: var(--dark);
        }
        
        .filter-btn {
            background: white;
            border: 1px solid #eee;
            padding: 10px 18px;
            border-radius: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all var(--anim);
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .filter-btn:hover {
            border-color: var(--secondary);
            color: var(--secondary);
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        }
        
       /* 2. Garantir que a grid se ajuste corretamente */
.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 25px;
    margin-top: 20px;
    grid-auto-rows: unset; /* Alterado para permitir rows de tamanho natural */
}
        
      .card {
    background: white;
    border-radius: var(--card-radius);
    box-shadow: var(--shadow);
    overflow: visible; /* Alterado para permitir que o conte√∫do extravase se necess√°rio */
    transition: transform var(--anim), box-shadow var(--anim);
    display: flex;
    flex-direction: column;
    position: relative;
    height: auto; /* Alterado de 100% para auto */
    border: 1px solid rgba(0,0,0,0.04);
    will-change: transform, box-shadow;
}
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            padding: 22px 20px 12px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            align-items: flex-start;
        }
        
        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
            line-height: 1.3;
            max-width: 80%;
        }
        
        .card-tag {
            font-size: 0.75rem;
            background: var(--light);
            padding: 4px 10px;
            border-radius: 12px;
            color: var(--text-light);
            font-weight: 500;
            white-space: nowrap;
        }
        
      .card-body {
    padding: 15px 20px;
    flex: 1 0 auto; /* Alterado para permitir crescimento, mas n√£o encolhimento */
    display: flex;
    flex-direction: column;
    background-color: white;
}
        
    .card-info {
    line-height: 1.6;
    color: var(--text);
    margin-bottom: 15px;
    overflow: visible; /* Alterado de 'hidden' para 'visible' */
    -webkit-line-clamp: unset; /* Remover a limita√ß√£o de linhas */
    -webkit-box-orient: vertical;
    flex: 1;
    white-space: pre-line; /* Mantido para preservar quebras de linha */
    font-size: 0.95rem;
}
        
        .card.no-image .card-info {
            -webkit-line-clamp: unset;
            white-space: normal;
        }
        
        .card-footer {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.02);
            border-top: 1px solid rgba(0,0,0,0.05);
        }
        
        .card-btn {
            padding: 10px 18px;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.9rem;
            border: none;
            cursor: pointer;
            transition: all var(--anim);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .primary-btn {
            background: var(--secondary);
            color: white;
            box-shadow: 0 2px 5px rgba(52, 152, 219, 0.3);
        }
        
        .primary-btn:hover {
            background: var(--dark);
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.4);
        }
        
        .outline-btn {
            background: transparent;
            border: 1px solid #ddd;
        }
        
        .outline-btn:hover {
            border-color: var(--secondary);
            color: var(--secondary);
            background: rgba(52, 152, 219, 0.05);
        }
        
        .card-image {
            width: 100%;
            display: block;
            max-height: 220px;
            object-fit: contain;
            background-color: #f8f9fa;
            padding: 12px;
            border-top: 1px solid rgba(0,0,0,0.03);
            transition: transform 0.5s ease;
            will-change: transform;
        }
        
        .image-container {
            width: 100%;
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            overflow: hidden;
            min-height: 120px;
            border-top: 1px solid rgba(0,0,0,0.05);
            cursor: pointer;
            position: relative;
        }
        
        .image-container:hover img {
            transform: scale(1.03);
        }
        
        .image-container::after {
            content: "üîç";
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(255,255,255,0.8);
            padding: 6px;
            border-radius: 50%;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(5px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .image-container:hover::after {
            opacity: 1;
            transform: translateY(0);
        }
        
        .image-container a {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .card-meta {
            font-size: 0.85rem;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .card-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .icon {
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: var(--secondary);
            opacity: 0.7;
        }
        
        .card-actions {
            position: absolute;
            top: 12px;
            right: 12px;
            opacity: 0;
            transition: opacity var(--anim), transform var(--anim);
            background: rgba(255,255,255,0.95);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transform: translateY(-5px);
            z-index: 5;
        }
        
        .card:hover .card-actions {
            opacity: 1;
            transform: translateY(0);
        }
        
        .card-actions:hover {
            background: white;
            box-shadow: 0 3px 8px rgba(0,0,0,0.12);
        }
        
        .placeholder {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 300px;
            color: var(--text-light);
            text-align: center;
            background: white;
            border-radius: var(--card-radius);
            box-shadow: var(--shadow);
            padding: 30px;
        }
        
        .placeholder i {
            font-size: 3rem;
            opacity: 0.2;
            margin-bottom: 20px;
            color: var(--secondary);
        }
        
        .placeholder p {
            font-size: 1.1rem;
            max-width: 300px;
            margin: 10px auto;
        }
        
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-bottom-color: var(--secondary);
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1.2s linear infinite;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 15px rgba(255,255,255,0.5);
        }
        
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease forwards;
            will-change: opacity, transform;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .error-msg {
            background: #ff7675;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
            font-weight: 500;
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.2);
        }
        
        .inline-link {
            color: var(--secondary);
            text-decoration: none;
            word-break: break-all;
            transition: color var(--anim);
            position: relative;
            display: inline-block;
        }
        
        .inline-link:hover {
            color: var(--dark);
            text-decoration: underline;
        }
        
        .card-info a {
            font-weight: 500;
        }
        
     /* Sistema de cores por prioridade */

/* Alta prioridade - Vermelho (j√° existe, mas vamos melhorar) */
.high-priority {
    border-left: 4px solid #e74c3c;
    position: relative;
}

.high-priority::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, #e74c3c, #e74c3c 70%, transparent);
    z-index: 1;
}

/* M√©dia prioridade - Laranja */
.medium-priority {
    border-left: 4px solid #f39c12;
    position: relative;
}

.medium-priority::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, #f39c12, #f39c12 70%, transparent);
    z-index: 1;
}

/* Baixa prioridade - Verde */
.low-priority {
    border-left: 4px solid #2ecc71;
    position: relative;
}

.low-priority::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, #2ecc71, #2ecc71 70%, transparent);
    z-index: 1;
}

/* Adicionar um indicador visual de prioridade no canto superior */
.priority-indicator {
    position: absolute;
    top: 0;
    left: 0;
    font-size: 0.7rem;
    padding: 3px 7px;
    border-radius: 0 0 4px 0;
    font-weight: 600;
    z-index: 2;
    color: white;
}

.high-priority .priority-indicator {
    background-color: #e74c3c;
}

.medium-priority .priority-indicator {
    background-color: #f39c12;
}

.low-priority .priority-indicator {
    background-color: #2ecc71;
}
        
        .card-info {
            word-break: break-word;
        }
        
        .card.no-image {
            min-height: 250px;
            display: flex;
            flex-direction: column;
        }
        
        .card.no-image .card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        /* Estilos das imagens de controle */
        .fa-search, .fa-sort, .fa-filter, .fa-external-link-alt, .fa-ellipsis-v,
        .fa-info-circle, .fa-calendar-alt, .fa-user {
            display: inline-block;
            width: 1em;
            height: 1em;
            line-height: 1;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.7rem;
            }
            
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                max-width: none;
            }
            
            .card-info {
                -webkit-line-clamp: 8;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>MURAL DE TAREFAS/AVISOS E EVENTOS - EQUIPE SORVETERIA</h1>
            <p>Fique de olho nas informa√ß√µes mais importantes da equipe: Eventos, mudan√ßas, rotas de entregas, solicita√ß√µes urgentes. Desfrute de informa√ß√µes visuais e bem organizadas para mamter o foco nas vendas!</p>
        </div>
    </header>
    
    <div class="container">
        <div class="toolbar">
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Buscar informa√ß√µes...">
                <button id="search-btn"><i class="fas fa-search"></i></button>
            </div>
            <div>
                <button class="filter-btn" id="sort-btn">
                    <i class="fas fa-sort"></i> Ordenar
                </button>
                <button class="filter-btn" id="filter-btn">
                    <i class="fas fa-filter"></i> Filtrar
                </button>
            </div>
        </div>
        
        <div id="error-msg" class="error-msg"></div>
        
        <div id="loader" class="loader"></div>
        
        <div id="content-grid" class="grid" style="display: none;"></div>
    </div>
    
    <script>
        // Configura√ß√£o da API do Google Sheets
        const spreadsheetId = "1x8_k27RWofNxNYDfWtC9skTEWPksk9dRHMhay6QCspU";
        const apiKey = "AIzaSyB_DqAfjDQHOGESUrUboqiVYv0qGa1WeJc";
        const sheetName = "Mural";
        
        /* Estrutura da planilha:
        * Coluna A: T√≠tulo do card
        * Coluna B: Informa√ß√µes/descri√ß√£o
        * Coluna C: Link para acessar
        * Coluna D: Link da imagem
        * Coluna E: Prazo (formato DD/MM/AAAA)
        * Coluna F: Categoria (ex: Documento, Recurso, Link)
        * Coluna G: Autor/Respons√°vel
        * Coluna H: Prioridade (Normal, Alta)
        */
        
        // Estado da aplica√ß√£o
        let allItems = [];
        let filteredItems = [];
        let sortDirection = 'asc';
        let isLoading = true;
        
        // Elementos DOM
        const contentGrid = document.getElementById('content-grid');
        const loader = document.getElementById('loader');
        const errorMsg = document.getElementById('error-msg');
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        const sortBtn = document.getElementById('sort-btn');
        const filterBtn = document.getElementById('filter-btn');
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', init);
        
        function init() {
            setupEventListeners();
            
            // Usar requestAnimationFrame para melhorar o desempenho
            requestAnimationFrame(() => {
                loadData();
            });
        }
        
        function setupEventListeners() {
            searchInput.addEventListener('keyup', event => {
                if (event.key === 'Enter') {
                    filterItems(searchInput.value);
                }
            });
            
            searchBtn.addEventListener('click', () => {
                filterItems(searchInput.value);
            });
            
            sortBtn.addEventListener('click', () => {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
                sortBtn.innerHTML = `<i class="fas fa-sort"></i> ${sortDirection === 'asc' ? 'A-Z' : 'Z-A'}`;
                sortItems();
            });
            
            filterBtn.addEventListener('click', () => {
                // Em uma vers√£o real, abriria um modal de filtros
                // Simplifica√ß√£o para demonstra√ß√£o
                const randomFilter = ['Todos', 'Recursos', 'Documentos', 'Links'];
                const filterText = randomFilter[Math.floor(Math.random() * randomFilter.length)];
                filterBtn.innerHTML = `<i class="fas fa-filter"></i> ${filterText}`;
                
                if (filterText === 'Todos') {
                    filteredItems = [...allItems];
                } else {
                    filteredItems = allItems.filter(item => 
                        item.titulo.toLowerCase().includes(filterText.toLowerCase())
                    );
                }
                
                renderCards();
            });
        }
        
        function loadData() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${sheetName}?key=${apiKey}`;
            
            // Usar fetch com caching
            fetch(url, { 
                cache: 'default',
                credentials: 'same-origin'
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Falha ao conectar com a API do Google Sheets");
                    }
                    return response.json();
                })
                .then(data => {
                    processData(data);
                    isLoading = false;
                    hideLoader();
                    renderCards();
                })
                .catch(error => {
                    showError("N√£o foi poss√≠vel carregar os dados. " + error.message);
                    isLoading = false;
                    hideLoader();
                });
        }
        
        function processData(data) {
            if (!data.values || data.values.length <= 1) {
                showError("Nenhum dado encontrado na planilha.");
                return;
            }
            
            // Criar um DocumentFragment para processamento em lote
            const fragment = document.createDocumentFragment();
            
            // Processar cada linha de dados (pulando cabe√ßalhos)
            for (let i = 1; i < data.values.length; i++) {
                const row = data.values[i];
                if (row.length < 3) continue; // Pular linhas incompletas
                
                const item = {
                    titulo: row[0] || "Sem t√≠tulo",
                    informacao: row[1] || "Sem descri√ß√£o",
                    linkAcesso: row[2] || "",
                    linkImagem: row.length > 3 ? row[3] || "" : "",
                    data: row.length > 4 ? row[4] || "" : new Date().toLocaleDateString('pt-BR'),
                    categoria: row.length > 5 ? row[5] || "" : "Geral",
                    autor: row.length > 6 ? row[6] || "" : "",
                    prioridade: row.length > 7 ? row[7] || "" : "Normal",
                    id: `item-${i}`
                };
                
                allItems.push(item);
            }
            
            // Inicializar os itens filtrados
            filteredItems = [...allItems];
        }
        
        // Cache para processamento de links
        const linkCache = new Map();
        
        function renderCards() {
            if (isLoading) return;
            
            // Limpar grid e mostrar
            contentGrid.innerHTML = '';
            contentGrid.style.display = 'grid';
            
            if (filteredItems.length === 0) {
                contentGrid.innerHTML = `
                    <div class="placeholder">
                        <div>
                            <i class="fas fa-search"></i>
                            <p>Nenhum item encontrado com estes crit√©rios.</p>
                            <p style="opacity: 0.7; font-size: 0.9rem; margin-top: 10px;">Tente ajustar sua busca ou filtros.</p>
                        </div>
                    </div>`;
                return;
            }
            
            // Usar fragment para evitar reflows
            const fragment = document.createDocumentFragment();
            const batchSize = 5; // Quantos cards processar por vez
            let currentIndex = 0;
            
            function renderBatch() {
                if (currentIndex >= filteredItems.length) return;
                
                const endIndex = Math.min(currentIndex + batchSize, filteredItems.length);
                
                for (let i = currentIndex; i < endIndex; i++) {
                    const card = createCard(filteredItems[i]);
                    card.classList.add('fade-in');
                    fragment.appendChild(card);
                }
                
                // Adicionar batch ao DOM
                contentGrid.appendChild(fragment);
                
                // Configurar pr√≥ximo batch
                currentIndex = endIndex;
                if (currentIndex < filteredItems.length) {
                    requestAnimationFrame(renderBatch);
                }
            }
            
            // Iniciar renderiza√ß√£o em batches
            requestAnimationFrame(renderBatch);
        }
        
        // Fun√ß√£o aprimorada para transformar URLs em links clic√°veis e preservar quebras de linha
function makeLinksClickable(text) {
    if (!text) return '';
    
    // Verificar se j√° temos este texto processado no cache
    if (linkCache.has(text)) {
        return linkCache.get(text);
    }
    
    // Primeiro, substituir quebras de linha por <br>
    // A propriedade white-space: pre-line j√° cuida disso, mas vamos garantir
    // que sejam preservadas corretamente tanto no HTML quanto no CSS
    let processedText = text.replace(/\n/g, '<br>');
    
    // Regex para encontrar URLs em um texto
    const urlRegex = /(https?:\/\/[^\s]+)/g;
    
    // Substituir URLs por links clic√°veis
    processedText = processedText.replace(urlRegex, url => {
        return `<a href="${url}" target="_blank" class="inline-link">${url}</a>`;
    });
    
    // Armazenar no cache para uso futuro
    linkCache.set(text, processedText);
    
    return processedText;
}
        
       function createCard(item) {
    const card = document.createElement('div');
    card.className = 'card';
    card.id = item.id;
    
    // Verificar se o card tem imagem
    if (!item.linkImagem) {
        card.classList.add('no-image');
    }
    
    // Usar a categoria da planilha ou o padr√£o se n√£o existir
    const cardType = item.categoria || 'Geral';
    
    // Definir classe de prioridade para estiliza√ß√£o
    let priorityLabel = '';
    if (item.prioridade) {
        const priority = item.prioridade.toLowerCase();
        if (priority === 'alta') {
            card.classList.add('high-priority');
            priorityLabel = 'Alta';
        } else if (priority === 'm√©dia' || priority === 'media') {
            card.classList.add('medium-priority');
            priorityLabel = 'M√©dia';
        } else if (priority === 'baixa') {
            card.classList.add('low-priority');
            priorityLabel = 'Baixa';
        }
    }
    
    // Processar o texto para transformar URLs em links clic√°veis
    const processedInfo = makeLinksClickable(item.informacao);
    
    let cardHtml = `
        <div class="card-header">
            <h3 class="card-title">${item.titulo}</h3>
            <span class="card-tag">${cardType}</span>
        </div>`;
    
    // Adicionar indicador de prioridade se for diferente de normal/vazio
    if (priorityLabel) {
        cardHtml += `<span class="priority-indicator">${priorityLabel}</span>`;
    }
    
    cardHtml += `
        <div class="card-body">
            <p class="card-info">${processedInfo}</p>
        </div>
        <div class="card-footer">
            <div class="card-meta">`;
    
    // Adicionar metadados se estiverem dispon√≠veis
    if (item.data) {
        cardHtml += `<span><i class="fas fa-calendar-alt icon"></i> Prazo: ${item.data}</span>`;
    }
    
    if (item.autor) {
        cardHtml += `<span><i class="fas fa-user icon"></i> ${item.autor}</span>`;
    }
    
    cardHtml += `</div>`;
    
    if (item.linkAcesso) {
        cardHtml += `
            <a href="${item.linkAcesso}" target="_blank" class="card-btn primary-btn">
                <i class="fas fa-external-link-alt"></i> Acessar
            </a>`;
    } else {
        cardHtml += `
            <button class="card-btn outline-btn">
                <i class="fas fa-info-circle"></i> Detalhes
            </button>`;
    }
    
    cardHtml += `</div>`;
    
    // Adicionar imagem se existir
    if (item.linkImagem) {
        cardHtml += `<div class="image-container">
            <a href="${item.linkImagem}" target="_blank" title="Ver imagem em tamanho original">
                <img src="${item.linkImagem}" alt="${item.titulo}" class="card-image" loading="lazy" onerror="this.parentNode.parentNode.style.display='none'; card.classList.add('no-image');">
            </a>
        </div>`;
    }
    
    cardHtml += `<div class="card-actions"><i class="fas fa-ellipsis-v"></i></div>`;
    
    card.innerHTML = cardHtml;
    return card;
}
        
        function filterItems(query) {
            query = query.toLowerCase().trim();
            
            if (!query) {
                filteredItems = [...allItems];
            } else {
                filteredItems = allItems.filter(item => 
                    item.titulo.toLowerCase().includes(query) || 
                    item.informacao.toLowerCase().includes(query)
                );
            }
            
            renderCards();
        }
        
        function sortItems() {
            filteredItems.sort((a, b) => {
                if (sortDirection === 'asc') {
                    return a.titulo.localeCompare(b.titulo);
                } else {
                    return b.titulo.localeCompare(a.titulo);
                }
            });
            
            renderCards();
        }
        
        function showError(message) {
            errorMsg.textContent = message;
            errorMsg.style.display = 'block';
        }
        
        function hideLoader() {
            loader.style.display = 'none';
        }
        
        // Adicionar monitoramento de desempenho
        const perfMetrics = {
            loadStart: performance.now(),
            renderTime: 0,
            totalItems: 0
        };
        
        // Adiciona evento de carregamento da janela para medir desempenho
        window.addEventListener('load', () => {
            const loadTime = performance.now() - perfMetrics.loadStart;
            console.log(`Dashboard carregado em ${loadTime.toFixed(2)}ms`);
        });
        
        // Fun√ß√£o otimizada de debounce para pesquisa
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // Aplicar debounce √† fun√ß√£o de filtro
        const debouncedFilter = debounce((query) => {
            filterItems(query);
        }, 300);
        
        // Substituir o evento keyup por um com debounce
        searchInput.addEventListener('input', (event) => {
            debouncedFilter(event.target.value);
        });
    </script>
</body>
</html>
