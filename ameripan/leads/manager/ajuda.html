<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Ajuda ‚Äî Gestor de Leads PRO (v7.4.x)</title>
  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f1a2f;
      --panel2:#0d162a;
      --text:#e8eefc;
      --muted:#a7b6d9;
      --brand:#55c1ff;
      --ok:#3ddc97;
      --warn:#ffcc66;
      --bad:#ff6b6b;
      --line: rgba(255,255,255,.12);
      --shadow: 0 18px 55px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:
        radial-gradient(1200px 700px at 18% 10%, rgba(85,193,255,.18), transparent 55%),
        radial-gradient(1200px 700px at 85% 20%, rgba(61,220,151,.12), transparent 55%),
        radial-gradient(900px 600px at 50% 95%, rgba(255,204,102,.10), transparent 60%),
        var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial;
      line-height:1.5;
    }
    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1200px; margin:0 auto; padding:18px}
    .hero{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
      position:relative;
      overflow:hidden;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(600px 240px at 25% 10%, rgba(85,193,255,.16), transparent 62%),
        radial-gradient(600px 240px at 70% 18%, rgba(61,220,151,.12), transparent 62%);
      pointer-events:none;
    }
    .hero>*{position:relative}
    h1{margin:0 0 6px; font-size:22px; letter-spacing:.2px}
    .sub{margin:0; color:var(--muted); font-size:14px}
    .meta{margin-top:10px; display:flex; flex-wrap:wrap; gap:10px; color:var(--muted); font-size:13px}
    .badge{padding:6px 10px; border-radius:999px; border:1px solid var(--line); background:rgba(255,255,255,.04)}

    .grid{margin-top:14px; display:grid; grid-template-columns: 330px 1fr; gap:14px; align-items:start}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} .toc{position:static !important} }

    .card{background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02)); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow)}
    .toc{position:sticky; top:14px; padding:14px}
    .toc h2{margin:0 0 10px; font-size:15px}
    .toc a{display:block; padding:7px 10px; border-radius:12px; color:var(--muted)}
    .toc a:hover{background:rgba(85,193,255,.10); color:var(--text); text-decoration:none}
    .toc .note{margin-top:12px; font-size:12px; color:var(--muted); border-top:1px dashed var(--line); padding-top:10px}

    .content{padding:14px}
    h2{margin:18px 0 8px; font-size:18px}
    h3{margin:16px 0 6px; font-size:15px; color:#dfe8ff}
    p{margin:8px 0; color:#d8e2ff}
    .muted{color:var(--muted)}

    .callout{border:1px solid var(--line); background:rgba(0,0,0,.20); border-radius:16px; padding:12px; margin:10px 0}
    .callout strong{color:#eef4ff}

    ul,ol{margin:8px 0 8px 20px}
    li{margin:6px 0; color:#d8e2ff}

    code{
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      padding:2px 6px;
      border-radius:10px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:12px;
      color:#f2f6ff;
    }
    pre{padding:12px; border-radius:16px; border:1px solid var(--line); background:rgba(0,0,0,.25); overflow:auto}
    pre code{background:transparent; border:none; padding:0; font-size:12px}

    table{width:100%; border-collapse:separate; border-spacing:0; margin:10px 0; border:1px solid var(--line); border-radius:16px; overflow:hidden}
    th,td{padding:10px; border-bottom:1px solid rgba(255,255,255,.08); text-align:left; vertical-align:top}
    th{font-size:12px; color:var(--muted); letter-spacing:.25px; background:rgba(255,255,255,.04)}
    tr:last-child td{border-bottom:none}

    details{border:1px solid var(--line); background:rgba(255,255,255,.03); border-radius:16px; padding:10px 12px; margin:10px 0}
    summary{cursor:pointer; font-weight:800; color:#f2f6ff}

    .pill{display:inline-flex; gap:6px; align-items:center; padding:3px 10px; border-radius:999px; border:1px solid var(--line); background:rgba(255,255,255,.04); color:var(--muted); font-size:12px; margin:2px 6px 2px 0; white-space:nowrap}
    .ok{color:var(--ok)}
    .warn{color:var(--warn)}
    .bad{color:var(--bad)}
    .icon{width:24px; display:inline-block; text-align:center}
    .two{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    @media (max-width:820px){ .two{grid-template-columns:1fr} }

    .foot{margin:14px 0 22px; text-align:center; color:var(--muted); font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <h1>Ajuda ‚Äî Gestor de Leads PRO (linha v7.4.x)</h1>
      <p class="sub">Manual do b√°sico ao avan√ßado: importa√ß√£o MapsScraper, clientes ativos, √≠cones, backup, Google Sheets (modo completo com Web App), sincroniza√ß√£o bidirecional, v√≠nculo Lead‚ÜîCliente e cuidado cr√≠tico com Latitude/Longitude no Sheets (pt-BR).</p>
      <div class="meta">
        <span class="badge">Atualizado em: 2026-02-15 06:12</span>
        <span class="badge">Compat√≠vel com: v7.4.4+</span>
        <span class="badge">Conector recomendado: Apps Script v1.4.2+ / v1.4.1+</span>
      </div>

      <div class="callout" style="margin-top:12px">
        <strong class="warn">Regra de ouro:</strong> o Gestor salva dados localmente no navegador (IndexedDB/localStorage).
        <ul>
          <li><strong>N√ÉO apague cookies/dados do site</strong> (isso pode apagar seu banco local).</li>
          <li>Use <strong>Backup</strong> e/ou sincronize com Google Sheets (modo completo).</li>
        </ul>
      </div>

      <div class="callout">
        <strong class="bad">Cr√≠tico (GPS):</strong> em planilhas pt-BR, o Google Sheets pode interpretar ponto como separador de milhar e ‚Äúquebrar‚Äù coordenadas.
        <p class="muted">A solu√ß√£o ideal (j√° implementada nas vers√µes novas) √© gravar Latitude/Longitude como <strong>TEXTO</strong> no Sheets e manter como <strong>string</strong> no app.</p>
      </div>
    </div>

    <div class="grid">
      <div class="card toc">
        <h2>√çndice</h2>
        <a href="#start">1) Come√ßar r√°pido</a>
        <a href="#basico">2) Conceitos: Lead x Cliente</a>
        <a href="#mapsscraper">3) MapsScraper: padr√£o de colunas (XLSX)</a>
        <a href="#leads">4) Leads: fluxo e campos</a>
        <a href="#clients">5) Clientes: fluxo, C√≥d. Cliente e campos extras</a>
        <a href="#link">6) Liga√ß√£o Lead ‚Üî Cliente (chaves)</a>
        <a href="#agenda">7) Agenda / Pr√≥ximas a√ß√µes</a>
        <a href="#sets">8) Conjuntos</a>
        <a href="#backup">9) Backup e Importar Backup</a>
        <a href="#sheets">10) Google Sheets: modo simples x modo completo</a>
        <a href="#webapp">11) Passo a passo: Web App (Apps Script)</a>
        <a href="#bidirecional">12) Push/Pull (bidir) e organiza√ß√£o das abas</a>
        <a href="#coords">13) Latitude/Longitude sem convers√£o (garantia total)</a>
        <a href="#icons">14) Guia de √≠cones (A√ß√µes)</a>
        <a href="#faq">15) FAQ e problemas comuns</a>

        <div class="note">
          Use este arquivo como <code>ajuda.html</code> na mesma pasta do Gestor (GitHub Pages).
        </div>
      </div>

      <div class="card content">

        <h2 id="start">1) Come√ßar r√°pido</h2>
        <ol>
          <li>Abra o Gestor (Chrome recomendado).</li>
          <li>Escolha o <strong>Conjunto</strong> no topo (ex.: ‚ÄúLeads Padr√£o‚Äù).</li>
          <li>Importe seus <strong>Leads</strong> (XLSX/CSV do MapsScraper).</li>
          <li>Importe <strong>Clientes Ativos</strong> (<code>Clientes.xlsx</code> no padr√£o de colunas).</li>
          <li>Fa√ßa um <strong>Backup</strong> e/ou configure <strong>Google Sheets (Web App)</strong> para sincronizar em outros dispositivos.</li>
        </ol>

        <details>
          <summary>Dica: usar como ‚Äúapp‚Äù no celular</summary>
          <p>No Android (Chrome): menu ‚ãÆ ‚Üí <strong>Adicionar √† tela inicial</strong>. Assim ele abre como um app.</p>
        </details>

        <h2 id="basico">2) Conceitos: Lead x Cliente</h2>
        <div class="two">
          <div class="callout">
            <strong>Lead</strong>
            <ul>
              <li>Prospect capturado (ex.: Google Maps).</li>
              <li>Voc√™ registra funil, pr√≥xima a√ß√£o, interesse e observa√ß√µes.</li>
              <li>Pode ter CPF/CNPJ para enriquecer dados e facilitar cadastro.</li>
            </ul>
          </div>
          <div class="callout">
            <strong>Cliente Ativo</strong>
            <ul>
              <li>J√° compra da empresa.</li>
              <li>Campo-chave: <strong>C√≥d. Cliente</strong> (c√≥digo interno).</li>
              <li>Tem dias de entrega, dia de visita, comprador, produtos de interesse.</li>
            </ul>
          </div>
        </div>

        <h2 id="mapsscraper">3) MapsScraper: padr√£o de colunas (XLSX)</h2>
        <p>O Gestor suporta o XLSX padr√£o do MapsScraper (como seu ‚ÄúRio_Claro Exemplo.xlsx‚Äù). Ele costuma vir com campos como:</p>
        <ul>
          <li><strong>Name</strong>, <strong>Category</strong>, <strong>Fulladdress</strong>, <strong>City</strong>, <strong>State</strong>, <strong>Zip</strong></li>
          <li><strong>Phone</strong>, <strong>Website</strong>, (√†s vezes <strong>Email</strong>)</li>
          <li><strong>Latitude</strong>, <strong>Longitude</strong> (alta precis√£o)</li>
          <li><strong>Google Maps URL</strong> (√†s vezes com <code>cid=...</code>)</li>
          <li><strong>Facebook</strong>, <strong>Instagram</strong>, <strong>Twitter</strong></li>
          <li><strong>Social Medias</strong> (pode vir como JSON)</li>
          <li><strong>Rating</strong>, <strong>Reviews</strong></li>
        </ul>

        <div class="callout">
          <strong>Redes sociais:</strong> o Gestor l√™ Facebook/Instagram/Twitter tanto das colunas individuais quanto do campo <code>Social Medias</code> (JSON).
        </div>

        <h2 id="leads">4) Leads: fluxo e campos</h2>
        <ol>
          <li>Abra Maps <span class="pill"><span class="icon">üó∫Ô∏è</span>Maps</span> para conferir o ponto.</li>
          <li>Contato WhatsApp <span class="pill"><span class="icon">üì±</span>WhatsApp</span> (sem mensagem) ou com template opcional.</li>
          <li>Registre <strong>observa√ß√µes</strong> e defina <strong>Pr√≥xima a√ß√£o</strong>.</li>
          <li>Se virar cliente, converta/exporte para o padr√£o de clientes ativos.</li>
        </ol>

        <details>
          <summary>Campos importantes no Lead</summary>
          <ul>
            <li><strong>cid</strong> e <strong>url</strong> (Maps URL/CID) ajudam a identificar e evitar duplicados.</li>
            <li><strong>lat</strong> e <strong>lng</strong> para navega√ß√£o GPS real (mantidos com precis√£o total).</li>
            <li><strong>doc</strong> e <strong>docDigits</strong> para CPF/CNPJ (enriquecimento).</li>
            <li><strong>cod</strong> (opcional): ajuda a vincular lead com cliente ativo (c√≥digo interno).</li>
          </ul>
        </details>

        <h2 id="clients">5) Clientes: fluxo, C√≥d. Cliente e campos extras</h2>
        <div class="callout">
          <strong class="ok">Novidade v7.4.x:</strong> clientes podem armazenar tamb√©m (opcional) os campos de ‚Äúcontato/links/GPS‚Äù:
          <p class="muted">phone, email, website, instagram, facebook, twitter, cid, url, lat, lng, doc, docDigits, sourceLeadId</p>
        </div>

        <p>Esses campos <strong>n√£o s√£o obrigat√≥rios</strong>, mas ficam dispon√≠veis no modal de Cliente Ativo para preencher e sincronizar.</p>

        <h2 id="link">6) Liga√ß√£o Lead ‚Üî Cliente (chaves)</h2>
        <p>O Gestor consegue identificar que ‚Äúum lead j√° √© cliente‚Äù e sincronizar dados por uma ou mais chaves:</p>
        <ul>
          <li><strong>convertedClientId</strong> (link direto do lead para o cliente gerado)</li>
          <li><strong>cid</strong> (Google Maps CID)</li>
          <li><strong>cod</strong> (Lead) ‚Üî <strong>codCliente</strong> (Cliente)</li>
          <li><strong>telefone</strong> (comparando lead.phone com client.whatsapp e client.phone)</li>
        </ul>

        <div class="callout">
          <strong>Como a sincroniza√ß√£o funciona:</strong>
          <ul>
            <li>Por padr√£o, o sistema <strong>preenche campos vazios</strong> (n√£o sobrescreve o que j√° est√° preenchido).</li>
            <li>Assim, dados ricos (lat/lng, url/cid, redes sociais) podem ser ‚Äúenriquecidos‚Äù do lead para o cliente.</li>
          </ul>
        </div>

        <h2 id="agenda">7) Agenda / Pr√≥ximas a√ß√µes</h2>
        <p>A Agenda junta os itens com ‚ÄúPr√≥xima a√ß√£o‚Äù e ‚ÄúPr√≥xima visita‚Äù, incluindo atrasados.</p>

        <h2 id="sets">8) Conjuntos</h2>
        <p>Um Conjunto √© um ‚Äúbanco separado‚Äù dentro do Gestor (campanhas/rotas/cidades).</p>
        <p>No modo Google Sheets (Web App), cada conjunto grava em:</p>
        <ul>
          <li><code>LEADS__&lt;setId&gt;</code></li>
          <li><code>CLIENTS__&lt;setId&gt;</code></li>
        </ul>

        <h2 id="backup">9) Backup e Importar Backup</h2>
        <ul>
          <li><span class="pill"><span class="icon">üíæ</span>Backup</span> baixa um JSON com todos os dados do navegador.</li>
          <li><span class="pill"><span class="icon">üì•</span>Importar Backup</span> restaura esse JSON.</li>
        </ul>

        <h2 id="sheets">10) Google Sheets: modo simples x modo completo</h2>
        <div class="two">
          <div class="callout">
            <strong>Modo simples (API Key) ‚Äî Somente leitura</strong>
            <ul>
              <li>Importa dados do Sheets para o Gestor.</li>
              <li>N√£o escreve de volta.</li>
            </ul>
          </div>
          <div class="callout">
            <strong>Modo completo (Web App / Apps Script) ‚Äî Bidir</strong>
            <ul>
              <li><strong>Pull</strong> (puxar) + <strong>Push</strong> (enviar)</li>
              <li>Auto-cria abas (SETS/SETTINGS/LEADS__/CLIENTS__)</li>
              <li>Ideal para sincronizar em outro celular/PC</li>
            </ul>
          </div>
        </div>

        <h2 id="webapp">11) Passo a passo: Web App (Apps Script)</h2>

        <h3>11.1) Abrir Apps Script dentro da planilha</h3>
        <ol>
          <li>Abra a planilha no Google Sheets.</li>
          <li>V√° em <strong>Extens√µes</strong> ‚Üí <strong>Apps Script</strong>.</li>
        </ol>

        <h3>11.2) Colar o c√≥digo .gs</h3>
        <ol>
          <li>Abra o arquivo <code>C√≥digo.gs</code> (ou <code>Code.gs</code>).</li>
          <li>Apague o conte√∫do atual.</li>
          <li>Cole o conte√∫do do conector (ex.: <code>Ameripan_SheetsConnector_AppsScript_v1.4.2.gs</code>).</li>
          <li>Clique em <strong>Salvar</strong> (ou <code>Ctrl+S</code>).</li>
        </ol>

        <h3>11.3) Implantar como Web App</h3>
        <ol>
          <li>Clique em <strong>Implantar</strong> (canto superior direito).</li>
          <li><strong>Nova implanta√ß√£o</strong> ‚Üí tipo <strong>Aplicativo da Web</strong>.</li>
          <li>Configure:
            <ul>
              <li><strong>Executar como:</strong> Voc√™</li>
              <li><strong>Quem pode acessar:</strong> Qualquer pessoa com o link</li>
            </ul>
          </li>
          <li>Clique em <strong>Implantar</strong>.</li>
        </ol>

        <h3>11.4) Autorizar</h3>
        <ol>
          <li>Quando pedir permiss√µes, clique em <strong>Autorizar</strong>.</li>
          <li>Escolha sua conta.</li>
          <li>Se aparecer ‚ÄúAplicativo n√£o verificado‚Äù: <strong>Avan√ßado</strong> ‚Üí <strong>Ir para (seu projeto)</strong>.</li>
        </ol>

        <h3>11.5) Copiar a URL /exec</h3>
        <div class="callout">
          <strong>Exemplo:</strong>
          <pre><code>https://script.google.com/macros/s/AKfycby1UN595v1EPq6BZgJ_rUIv1F63S0PKrR5am7HewoE8CkM1zr4uxjvmXAG2fKxmXLYS-g/exec</code></pre>
          <p class="muted">Copie a URL que termina em <code>/exec</code> (√© a URL do Web App).</p>
        </div>

        <h3>11.6) Onde colar a URL no Gestor</h3>
        <ol>
          <li>Abra o Gestor ‚Üí <span class="pill"><span class="icon">üß©</span>Config</span></li>
          <li>Se√ß√£o ‚ÄúGoogle Sheets ‚Äî Modo completo (Web App)‚Äù</li>
          <li>Cole no campo <strong>Web App URL</strong></li>
          <li>Salvar/Testar</li>
        </ol>

        <h2 id="bidirecional">12) Push/Pull (bidir) e organiza√ß√£o das abas</h2>
        <p>O Web App organiza a planilha em abas:</p>
        <ul>
          <li><code>SETS</code> ‚Üí lista de conjuntos</li>
          <li><code>SETTINGS</code> ‚Üí configura√ß√µes</li>
          <li><code>LEADS__default</code>, <code>CLIENTS__default</code> ‚Üí dados do conjunto ‚Äúdefault‚Äù</li>
          <li>Se voc√™ criar outros conjuntos: <code>LEADS__&lt;setId&gt;</code> e <code>CLIENTS__&lt;setId&gt;</code></li>
        </ul>
        <div class="callout">
          <strong>Recomenda√ß√£o:</strong>
          <ol>
            <li>No dispositivo novo: fa√ßa <strong>Pull</strong></li>
            <li>No final do dia: fa√ßa <strong>Push</strong></li>
          </ol>
        </div>

        <h2 id="coords">13) Latitude/Longitude sem convers√£o (garantia total)</h2>
        <div class="callout">
          <strong class="bad">Problema comum (pt-BR):</strong> o Sheets pode tratar ‚Äú.‚Äù como separador de milhar e destruir coordenadas.
          <p class="muted">Ex.: <code>-47.555873899999995</code> vira <code>-47.555.873.899.999.900</code></p>
        </div>
        <p><strong>Como garantir que nunca estrague:</strong></p>
        <ol>
          <li>No Sheets, formate colunas <strong>Latitude</strong> e <strong>Longitude</strong> como <strong>Texto simples</strong> (Formatar ‚Üí N√∫mero ‚Üí Texto simples).</li>
          <li>Use o conector atualizado (Apps Script v1.4.1+), que for√ßa formato texto automaticamente.</li>
          <li>No Gestor, coordenadas ficam salvas como <strong>string</strong> e s√≥ viram n√∫mero na hora do GPS.</li>
        </ol>

        <details>
          <summary>Se j√° estragou, como corrigir?</summary>
          <ul>
            <li>Formate as colunas como Texto simples.</li>
            <li>Fa√ßa um Pull e depois Push (as vers√µes novas corrigem e regravem).</li>
          </ul>
        </details>

        <h2 id="icons">14) Guia de √≠cones (A√ß√µes)</h2>
        <table>
          <thead><tr><th>√çcone</th><th>Quando aparece</th><th>O que faz</th></tr></thead>
          <tbody>
            <tr><td><span class="icon">üó∫Ô∏è</span></td><td>Endere√ßo / Maps URL / CID</td><td>Abre Google Maps (visualizar local).</td></tr>
            <tr><td><span class="icon">üìç</span></td><td>Lat/Lng preenchidos</td><td>Abre navega√ß√£o GPS por coordenadas.</td></tr>
            <tr><td><span class="icon">üì±</span></td><td>Telefone v√°lido</td><td>Abre WhatsApp <strong>sem mensagem</strong>.</td></tr>
            <tr><td><span class="icon">üí¨</span></td><td>Templates ativados</td><td>WhatsApp com mensagem padr√£o (opcional).</td></tr>
            <tr><td><span class="icon">‚úâÔ∏è</span></td><td>Email</td><td>Abre app de email.</td></tr>
            <tr><td><span class="icon">üåê</span></td><td>Website</td><td>Abre website.</td></tr>
            <tr><td><span class="icon">üì∑</span></td><td>Instagram</td><td>Abre link do Instagram.</td></tr>
            <tr><td><span class="icon">üìò</span></td><td>Facebook</td><td>Abre link do Facebook.</td></tr>
            <tr><td><span class="icon">üê¶</span></td><td>Twitter/X</td><td>Abre link do Twitter/X.</td></tr>
            <tr><td><span class="icon">‚úèÔ∏è</span></td><td>Sempre</td><td>Editar / anotar.</td></tr>
            <tr><td><span class="icon">üóëÔ∏è</span></td><td>Sempre</td><td>Excluir registro.</td></tr>
          </tbody>
        </table>

        <h2 id="faq">15) FAQ e problemas comuns</h2>
        <details>
          <summary>N√£o consigo acessar o Web App / d√° 403</summary>
          <ul>
            <li>Confirme que ‚ÄúQuem pode acessar‚Äù est√° como <strong>Qualquer pessoa com o link</strong>.</li>
            <li>Confirme que voc√™ est√° usando a URL que termina em <code>/exec</code>.</li>
            <li>Se voc√™ editou o c√≥digo, atualize a implanta√ß√£o (nova vers√£o).</li>
          </ul>
        </details>

        <details>
          <summary>Meus dados sumiram</summary>
          <ul>
            <li>Se voc√™ limpou dados do site, pode ter apagado o banco local.</li>
            <li>Use Importar Backup ou fa√ßa Pull (se voc√™ sincroniza no Sheets).</li>
          </ul>
        </details>

        <details>
          <summary>WhatsApp n√£o aparece</summary>
          <ul>
            <li>O √≠cone aparece somente se o telefone for v√°lido.</li>
            <li>Preferir salvar com DDI: <code>+55...</code></li>
          </ul>
        </details>

        <div class="foot">Ajuda v4 ‚Äî Gestor de Leads PRO ‚Ä¢ 2026-02-15 06:12</div>
      </div>
    </div>
  </div>
</body>
</html>
